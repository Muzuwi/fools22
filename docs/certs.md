## Cert stuff

Holder: `````Aelita`````
```authority=CrackerFour```

BD E6 D5 D7 DF D9 E6 C0 E3 E9 E6 - ```CrackerFour```

BB D9 E0 DD E8 D5 - ```Aelita```

Authority string is at ```0x02021dce```

```Aelita``` string at ```0x02021df0```

Cert? Is the byte at ```0x02021dc0``` the length?

```53000000D5E9E8DCE3E6DDE8ED35BDE6D5D7DFD9E6C0E3E9E6FAE7D9E6DDD5E035F7FE08FE68684FFADCE3E0D8D9E635BBD9E0DDE8D5FAE8EDE4D935E7DDE0EAD9E6FF00000000000000000000000000000000```

```53000000D5E9E8DCE3E6DDE8ED35BDE6D5D7DFD9E6C0E3E9E6FAE7D9E6DDD5E035F7FE08FE68684FFADCE3E0D8D9E635BBD9E0DDE8D5FAE8EDE4D935E7DDE0EAD9E6FF00000000000000000000000000000000```

Before being mangled to poke text format:

```53000000617574686F726974793D437261636B6572466F75722F73657269616C3D343835383636372F686F6C6465723D41656C6974612F747970653D73696C766572FF00000000000000000000000000000000```

```
00000000  53 00 00 00 61 75 74 68  6f 72 69 74 79 3d 43 72  |S...authority=Cr|
00000010  61 63 6b 65 72 46 6f 75  72 2f 73 65 72 69 61 6c  |ackerFour/serial|
00000020  3d 34 38 35 38 36 36 37  2f 68 6f 6c 64 65 72 3d  |=4858667/holder=|
00000030  41 65 6c 69 74 61 2f 74  79 70 65 3d 73 69 6c 76  |Aelita/type=silv|
00000040  65 72 ff 00 00 00 00 00  00 00 00 00 00 00 00 00  |er..............|
00000050  00 00 00                                          |...|
```

```authority=CrackerFour/serial=4858667/holder=Aelita/type=silver```

Renewal?
01F4F31E90310202C046C046C046C04600000001C046C046C046C046C046C04600000000
0139BAB690310202C046C046C046C04600000001C046C046C046C046C046C04600000000

Appraisal?
01FC8B2890310202C046C046C046C04600000001C046C046C046C046C046C04600000000010101010101FFFF00D6D9E4DDE7FF29C0082B31040600D2DB0302296B082B33040600DEDB0302296A082B34040600EADB030229670803291204291504293F04238DD0030233B501006A5A675EDC0302662305D003022343D10302210D800000060550DC03022367D30302210D800000060134DC0302040CDF03020505DC0302232FD4030228080023BFD3030204C3DB0302282000231FD403026C022F200067BBDD0302660559DC0302D1D9E0D7E3E1D900E8E300CEDCD9D4D4BBD4D4C1E0DDE8D7DCB4E7FEC0E3E3E0E7A3A1A3A3F0

Now renew the cert
Renewal - length 65 * 32-bit words

Transmit buffer is now at ```0x020186f0``` - **that's the cert!**

Oh shit it's base64

080000004954496E702B686353776650324335727654417979696A4F536972694D506D32444351314E712B76494A352B30464C564B6977337376714E66524773487A6157676E334F716877794B5A734439373634664F4F646A673D3DFF0000000217018037121200C71D020213006587010217018000001200DA75030213008C8701021200DB75030213008D8701021601800000160280A3001701800000180280010021028000000605898701021701805F121200C81D02021300B287010217018000001200DA7503021300D98701021200DB7503021300DA870102160180000016028067001701800000180280010021028000000605D68701021701807B101200C91D

Actual cert
080000004954496E702B68635377665032433572765441797970657662474335344233323753616B5650314F4D4D6D556A696C41767676594D7A52726562316C7568487476492B6230535A435572685557532F706845467037413D3D

So the cert is actually at <```0x020186f4```,```0x0201874b```>
(plus an ```FF`` terminator? doesn't seem to do anything).
Base64-encoded

**Invalid base64 input crashes the game! Base64 decoder doesn't handle it really well.**

C0
```4954496E702B6863537766503243357276544179796C4E52495578334634386E737678357A7A51304B71656168616C2F6E37435646347637754A4E3278647A576C6D4B6C493565526E6B6D6B7779644C7770796551773D3D```
```
00000000  21 32 27 a7 e8 5c 4b 07  cf d8 2e 6b bd 30 32 ca  |!2'..\K....k.02.|
00000010  53 51 21 4c 77 17 8f 27  b2 fc 79 cf 34 34 2a a7  |SQ!Lw..'..y.44*.|
00000020  9a 85 a9 7f 9f b0 95 17  8b fb b8 93 76 c5 dc d6  |............v...|
00000030  96 62 a5 23 97 91 9e 49  a4 c3 27 4b c2 9c 9e 43  |.b.#...I..'K...C|
00000040
```

C1
```4954496E702B6863537766503243357276544179796C425259396554346F31667569465963765068393549566857796B534734354B7838724339305855515134737449634B486C74337054476F332F7569676E482B513D3D```

C2
```4954496E702B6863537766503243357276544179796E4647573151664B347A4B52785955786A6C79575A4862477871723747674B496E66696E523669544757537A656374577052516243325A506F76644371615933513D3D```

C3 
```4954496E702B686353776650324335727654417979756355705A6B71676155774837703371746753753342334F4E727844627676307A2B49347246574F4571677462486141312F3566754246596E41647A7A667771513D3D```

Certs are 64 bytes

# Cert format

First 16 bytes - same for all certs?

```
00000000  21 32 27 a7 e8 5c 4b 07  cf d8 2e 6b bd 30 32 ca  |!2'..\K....k.02.|
```

Next 48 bytes - encrypted (?) data

## I don't know anymore

decrypting a cipher with multiple identical cipherblocks:
- equal plain block output if the cipherblocks are encrypted with the same key
- different plain block output otherwise
